THREE.STLExporter=class t{parse(t,e={}){let o=void 0!==e.binary&&e.binary,r=[],n=0;t.traverse(function(t){if(t.isMesh){let e=t.geometry,o=e.index,l=e.getAttribute("position");n+=null!==o?o.count/3:l.count/3,r.push({object3d:t,geometry:e})}});let l,i=80;if(!0===o){let s=2*n+48*n+80+4,a=new ArrayBuffer(s);(l=new DataView(a)).setUint32(i,n,!0),i+=4}else l="",l+="solid exported\n";let f=new THREE.Vector3,$=new THREE.Vector3,c=new THREE.Vector3,u=new THREE.Vector3,d=new THREE.Vector3,p=new THREE.Vector3;for(let x=0,m=r.length;x<m;x++){let b=r[x].object3d,y=r[x].geometry,g=y.index,w=y.getAttribute("position");if(null!==g)for(let V=0;V<g.count;V+=3){let z=g.getX(V+0),F=g.getX(V+1),A=g.getX(V+2);_(z,F,A,w,b)}else for(let M=0;M<w.count;M+=3){let h=M+0,v=M+1,T=M+2;_(h,v,T,w,b)}}return!1===o&&(l+="endsolid exported\n"),l;function _(t,e,r,n,s){var a,x,m;f.fromBufferAttribute(n,t),$.fromBufferAttribute(n,e),c.fromBufferAttribute(n,r),!0===s.isSkinnedMesh&&(s.boneTransform(t,f),s.boneTransform(e,$),s.boneTransform(r,c)),f.applyMatrix4(s.matrixWorld),$.applyMatrix4(s.matrixWorld),c.applyMatrix4(s.matrixWorld),a=f,x=$,m=c,u.subVectors(m,x),d.subVectors(a,x),u.cross(d).normalize(),p.copy(u).normalize(),!0===o?(l.setFloat32(i,p.x,!0),i+=4,l.setFloat32(i,p.y,!0),i+=4,l.setFloat32(i,p.z,!0),i+=4):(l+="	facet normal "+p.x+" "+p.y+" "+p.z+"\n",l+="		outer loop\n"),B(f),B($),B(c),!0===o?(l.setUint16(i,0,!0),i+=2):(l+="		endloop\n",l+="	endfacet\n")}function B(t){!0===o?(l.setFloat32(i,t.x,!0),i+=4,l.setFloat32(i,t.y,!0),i+=4,l.setFloat32(i,t.z,!0),i+=4):l+="			vertex "+t.x+" "+t.y+" "+t.z+"\n"}}};